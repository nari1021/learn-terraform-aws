# 3. 통사론

## 2. 구성 구문

Terraform 언어 구문은 인수와 블록이라는 2가지 주요 구문 구조를 중심으로 구축된다.

- 속성(인수): 특정 이름에 값을 할당한다.
- 블록: 다른 콘텐츠에 대한 컨테이너로 유형이 존재 ex) resource, variable, data, ...
- 식별자: 인수 이름, 블록 유형 이름 및 리소스, 입력 변수 등 과 같은 대부분의 Terraform 특정 구성의 이름
- 주석: `#`, `//`, `/*...*/` 을 사용
- 문자 인코딩: 항상 UTF-8
- 줄 끝: 관용적으로는 LF 이지만, CRLF도 사용할 수 있다.

## 3. JSON 구성 구문

대부분의 Terraform 구성은 기본 Terraform 언어 구문으로 작성되지만, JSON과 호환되는 대체 구문도 지원한다. `.tf.json`이라는 파일로 JSON 구문을 예상한다.

더 자세한 내용은 이 글 제일 하단에 참고 URL에서 확인해주세요..!

</br></br>

## 4. 스타일 규칙

Terraform 파서는 구성 파일의 요소를 배치하는 방법에 있어서 유연성을 제공하지만, 모듈간의 일관성을 위해 몇 가지 관용적 스타일 규칙이 있다.

```
$ terraform fmt
```

위의 명령어를 이용해서 자동으로 규칙을 적용할 수 있다.

- 각 중첩 수준에 대해 2개의 공백을 들여쓴다.
- 단일 행 값을 가진 여러 인수가 동일한 중첩 수준에서 연속 행에 나타날 때 등호를 정렬한다.
```
ami           = "abc123"
instance_type = "t2.micro"
```

- 블록 본문안에 인수와 블록이 함께 있으면, 모든 인수를 맨 위에 배치하고 중첩 블록을 아래에 배치하며, 빈 줄 하나를 이용하여 블록에서 인수를 구분한다.
- 블록 내에서 논리적 인수 그룹을 구분하려면 빈 줄을 사용한다.
- 인수와 "메타 인수"를 모두 포함하는 블록의 경우, ` 메타 인수 > 인수 > 다른 블록` 순서로 배치하며, 모두 한 줄의 공백으로 구분한다.
```
resource "aws_instance"  "example"  { 
  count  =  2  # meta-argument first 

  ami            =  "abc123" 
  instance_type  =  "t2.micro" 

  network_interface  { 
    # ... 
  } 

  lifecycle  {  # meta-argument block last 
    create_before_destroy  =  true 
  } 
}
```

- 최상위 블록은 항상 하나의 빈 줄로 분리되어야한다. 단, 동일한 유형의 관련 블록(`provisioner` 리소스의 여러 블록과 같은) 중첩된 블록을 함께 그룹화하는 경우는 제외한다.
- 블록 유형이 의미 체계에 의해 정의되어 가족화를 형성하지 않는다면 동일한 유형의 여러 블록을 다른 유형의 다른 블록과 분리하지 말아야한다.


# 참고
[JSON 구성 구문](https://www.terraform.io/language/syntax/json)
